(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(t){if(t.ep)return;t.ep=!0;const o=r(t);fetch(t.href,o)}})();class p{constructor(){this.ranks=["6","7","8","9","10","В","Д","К","Т"],this.suits=["c","d","s","h"],this.deck=[],this.create()}create(){for(let s=0;s<this.ranks.length;s+=1)for(let r=0;r<this.suits.length;r+=1){const n=new v(this.ranks[s],this.suits[r]);this.deck.push(n)}}select21(){const s=[];for(;;){const r=g(0,35);if(s.indexOf(r)===-1&&s.push(r),s.length===21)break}return s.map(r=>this.deck[r])}layOut3(s){const r=[],n=[],t=[];let o=0;for(;o<s.length;)r.push(s[o]),n.push(s[o+1]),t.push(s[o+2]),o+=3;return[r,n,t]}shiftPiles(s,r){return r==="left"?[s[1],s[0],s[2]]:r==="center"?[s[0],s[1],s[2]]:[s[0],s[2],s[1]]}}class v{constructor(s,r){this.rank=s,this.suit=r}}function g(m,s){return Math.floor(Math.random()*(s-1)+m)}class T{constructor(){this.deck=new p,this.cards=[],this.piles=[]}takeCards(){this.cards=this.deck.select21()}putCardsInOnePile(){this.cards=this.piles[0].concat(this.piles[1]).concat(this.piles[2])}spreadСardsIntoPiles(){this.piles=this.deck.layOut3(this.cards)}shiftPiles(s){this.piles=this.deck.shiftPiles(this.piles,s)}}class b{constructor(s){this.ctx=s,this.br=10,this.h=160,this.w=110,this.suits={h:"drawHeart",d:"drawDiamond",c:"drawClub",s:"drawSpade"}}drawFrame(s,r){const{ctx:n,br:t,w:o,h:l}=this;n.fillStyle="#EDEAEA",n.strokeStyle="silver",n.lineWidth="2",n.beginPath(),n.moveTo(s,r+t),n.lineTo(s,r+l-t),n.arcTo(s,r+l,s+t,r+l,t),n.lineTo(s+o-t,r+l),n.arcTo(s+o,r+l,s+o,r+l-t,t),n.lineTo(s+o,r+t),n.arcTo(s+o,r,s+o-t,r,t),n.lineTo(s+t,r),n.arcTo(s,r,s,r+t,t),n.save(),n.shadowBlur=3,n.shadowColor="black",n.shadowOffsetX=1,n.shadowOffsetY=1,n.stroke(),n.fill(),n.restore()}drawHeart(s,r,n){const{ctx:t,w:o,h:l}=this;t.fillStyle="red";const a=s+o/2,i=r+l/2,e=n||l/8,c=.25*e,h=Math.sqrt(e*e-c*c),d=h/2,u=[a-d,a+d];for(var f=0;f<2;f+=1)t.beginPath(),t.arc(u[f],i-c,d,0,Math.PI,!0),t.fill();t.beginPath(),t.moveTo(a+h,i-c),t.bezierCurveTo(a+e-e/6,i+e/3,a+e/6,i+e/3,a,i+e-e/5),t.bezierCurveTo(a-e/6,i+e/3,a-e+e/6,i+e/3,a-h,i-c),t.fill()}drawDiamond(s,r,n){const{ctx:t,w:o,h:l}=this;t.fillStyle="red";const a=s+o/2,i=r+l/2,e=n||l/8;t.beginPath(),t.moveTo(a,i-e),t.quadraticCurveTo(a+e/4,i-e/4,a+e,i),t.quadraticCurveTo(a+e/4,i+e/4,a,i+e),t.quadraticCurveTo(a-e/4,i+e/4,a-e,i),t.quadraticCurveTo(a-e/4,i-e/4,a,i-e),t.fill()}drawClub(s,r,n){const{ctx:t,w:o,h:l}=this;t.fillStyle="black";const a=s+o/2,i=r+l/2,e=n||l/8,c=e/2.5,h=[a,a+e/2.2,a-e/2.2],d=[i-e+e/2.2,i+e/7,i+e/7];for(var u=0;u<3;u+=1)t.beginPath(),t.arc(h[u],d[u],c,0,2*Math.PI,!0),t.fill();const f=i+Math.sqrt(e*e-Math.pow(e-e/2,2));t.beginPath(),t.moveTo(a,i),t.quadraticCurveTo(a,f,a+e-e/2,f),t.lineTo(a-e+e/2,f),t.quadraticCurveTo(a,f,a,i),t.fill()}drawSpade(s,r,n){const{ctx:t,w:o,h:l}=this;t.fillStyle="black";const a=s+o/2,i=r+l/2,e=n||l/8,c=.25*e,h=Math.sqrt(e*e-c*c),d=h/2;for(var u=[a-d,a+d],f=0;f<2;f+=1)t.beginPath(),t.arc(u[f],i+c,d,0,Math.PI,!1),t.fill();t.beginPath(),t.moveTo(a+h,i+c),t.bezierCurveTo(a+e-e/6,i-e/3,a+e/6,i-e/3,a,i-e+e/5),t.bezierCurveTo(a-e/6,i-e/3,a-e+e/6,i-e/3,a-h,i+c),t.fill();const w=i+Math.sqrt(e*e-Math.pow(e-e/1.5,2));t.beginPath(),t.moveTo(a,i),t.quadraticCurveTo(a,w,a+e-e/2,w),t.lineTo(a-e+e/2,w),t.quadraticCurveTo(a,w,a,i),t.fill()}drawRank(s,r,n,t){const{ctx:o,w:l,h:a}=this;o.fillStyle="black";const i=a/10,e=s+i,c=r+i,h=s+l-i,d=r+a-i;o.font="bold "+i+"px Times New Roman",o.fillText(t,e-i/2,c+i/2),o.fillText(t,h-i-i/2,d+i/6);const u=this.suits[n];this[u](e-l/2+i,c-a/2+i/4,i/2),this[u](h-l/2,d-a/2-i/6,i/2)}draw(s,r,n,t){const o=this.suits[n];this.drawFrame(s,r),this[o](s,r),this.drawRank(s,r,n,t)}}class y{constructor(){this.canvas=document.getElementById("canv"),this.ctx=this.canvas.getContext("2d"),this.cardRenderer=new b(this.ctx),this.message=document.getElementById("tips").children[0],this.reset(),this.animationDone=!0}reset(){const s=document.getElementById("vw");this.canvas.width=s.offsetWidth,this.canvas.height=s.offsetHeight}displayCards(s){let r=0,n=0,t=0,o=0;this.animationDone=!1;for(let l=0;l<s.length;l+=1){const a=s[l];let i,e;l%2===0?r+=5:r-=5,l%7===0&&l>0&&(r+=180,n=0),t+=75,i=75+97*n,e=15+r,n+=1,setTimeout(()=>{o+=1,this.cardRenderer.draw(i,e,a.suit,a.rank),o===21&&(this.animationDone=!0)},t)}}displayCardsInPiles(s){let r=0;this.animationDone=!1;const n=function(i){let e=0,c=0;return(i===2||i===6)&&(c=10),i===3&&(c=-10),i===6&&(c=-5),i%2===0?e=10:e=-10,e+c},t=300;let o=0,l=150,a=90;for(let i=0;i<3;i+=1){let e=s[i];for(let c=0;c<7;c+=1){const h=e[c],d=l+n(c),u=a;setTimeout(()=>{r+=1,this.cardRenderer.draw(d,u,h.suit,h.rank),r===21&&(this.animationDone=!0)},o),a+=35,o+=t}a=90,l+=200}}displayCard(s){const r=s[1][3];this.cardRenderer.draw(350,200,r.suit,r.rank)}showMessage(s){this.message.textContent=s}}class P{constructor(){this.model=new T,this.view=new y,this.level=0}init(){this.view.reset(),this.model.takeCards(),this.view.displayCards(this.model.cards),this.view.showMessage("Remember a card and press NEXT."),this.level=0}start(){this.view.reset(),this.model.spreadСardsIntoPiles(),this.view.displayCardsInPiles(this.model.piles),this.view.showMessage("Press NEXT, CENTER, RIGHT depending on in which pile your card is.")}next(s){this.view.reset(),this.model.shiftPiles(s),this.model.putCardsInOnePile(),this.model.spreadСardsIntoPiles(),this.level<2?this.view.displayCardsInPiles(this.model.piles):(this.view.displayCard(this.model.piles),this.view.showMessage("Is this your card?")),this.level+=1}}class C{constructor(){this.start=document.getElementById("start"),this.next=document.getElementById("next"),this.btns=document.getElementById("sel"),this.nextPressed=!1,this.counter=0,this.game=new P}init(){this.start.addEventListener("click",()=>{this.game.view.animationDone&&(this.game.init(),this.nextPressed=!1,this.counter=0)}),this.next.addEventListener("click",()=>{this.game.view.animationDone&&(this.nextPressed||(this.game.start(),this.nextPressed=!0))}),this.btns.addEventListener("click",s=>{if(!this.game.view.animationDone)return;const r=s.target.getAttribute("class").split(" ")[0];this.nextPressed&&this.counter<3&&(this.game.next(r),this.counter+=1)})}}const x=new C;x.init();
